#!/usr/bin/env node

const args = require('args')
const debug = require('debug')
const zmq = require('zeromq')

args
  .option('db', 'the path to database', 'echodb')
  .option('proto', 'the protocol to connect with', 'tcp')
  .option('ip', 'the ip to connect to', '127.0.0.1')
  .option('port', 'the port on to connect to', 3000)
  .option('debug', 'print debugging info', true)

const flags = args.parse(process.argv)

if (flags.debug) {
  debug.enable('*')
}

const log = debug('primea')
const address = `${flags.proto}://${flags.ip}:${flags.port}`

const sock = zmq.socket('pair')
sock.connect(address)

sock.on('message', (topic, message) => {
  sock.send([topic, message])
  process.exit(0)
})
